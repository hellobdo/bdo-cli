#!/bin/bash

# Get the CLI prefix from the executable path
CLI_PATH=$(dirname "$0")
CLI_PREFIX=$(basename "$0" | sed 's/-cli$//')

SCRIPTS_DIR="$(dirname "$CLI_PATH")/scripts"

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

# Show help message
show_help() {
    echo "Available commands:"
    echo "  ${CLI_PREFIX} create <repo-name> - Create and initialize a new repository"
    echo "  ${CLI_PREFIX} push - Add, commit, and push changes"
    echo "  ${CLI_PREFIX} branch <branch-name> - Create and push a new branch"
    echo "  ${CLI_PREFIX} checkout - Reset to match remote main branch"
}

case "$1" in
    "create")
        if [ -z "$2" ]; then
            echo "Usage: ${CLI_PREFIX} create <repo-name>"
            exit 1
        fi
        bash "$SCRIPTS_DIR/create.sh" "${@:2}"
        ;;
    "push")
        bash "$SCRIPTS_DIR/push.sh"
        ;;
    "branch")
        if [ -z "$2" ]; then
            echo "Usage: ${CLI_PREFIX} branch <branch-name>"
            exit 1
        fi
        bash "$SCRIPTS_DIR/branch.sh" "${@:2}"
        ;;
    "checkout")
        bash "$SCRIPTS_DIR/checkout.sh"
        ;;
    "help"|"--help"|"-h"|"")
        show_help
        ;;
    *)
        echo -e "${RED}Unknown command: $1${NC}"
        echo "Run '${CLI_PREFIX} help' to see available commands"
        exit 1
        ;;
esac 